<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:flex="http://www.springframework.org/schema/flex"
  xmlns:security="http://www.springframework.org/schema/security"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans 
  			  http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
              http://www.springframework.org/schema/flex 
              http://www.springframework.org/schema/flex/spring-flex-1.0.xsd
              http://www.springframework.org/schema/security
              http://www.springframework.org/schema/security/spring-security-2.0.4.xsd"> 
    
	
	<!-- Default config -->
	<flex:message-broker/>
	
	<!-- Custom services-config.xml path -->
	<flex:message-broker id="customServicesConfigPath" services-config-path="classpath:custom-services-config.xml"/>
	
	<!-- Custom ConfigurationManager -->
	<flex:message-broker id="customConfigManager" configuration-manager="configManager"/>
	
	<!-- Custom mappings -->
	<flex:message-broker id="customMappings"> 
		<flex:mapping pattern="/foo"/>
		<flex:mapping pattern="/bar"/>
	</flex:message-broker>
	
	<flex:message-broker id="disabledHandlerMapping" disable-default-mapping="true" />
	
	<flex:message-broker id="customConfigProcessors">
		<flex:config-processor ref="processor1"/>
		<flex:config-processor ref="processor2"/>
	</flex:message-broker>
	
	<flex:message-broker id="defaultSecured">
		<flex:secured/>
	</flex:message-broker>
	
	<flex:message-broker id="loginCommandConfigured" >
		<flex:secured per-client-authentication="true" invalidate-flex-session="false"/>
	</flex:message-broker>
	
	<flex:message-broker id="endpointSecured">
		<flex:secured>
			<flex:secured-channel access="ROLE_USER" channel="my-amf"/>
			<flex:secured-endpoint-path access="ROLE_ADMIN" pattern="**/admin/*"/>
			<flex:secured-endpoint-path access="ROLE_USER"/>
		</flex:secured>
	</flex:message-broker>
	
	<security:http auto-config="true"/>
	
	<security:authentication-provider>
		<security:user-service>
	    	<security:user name="jeremy" password="atlanta" authorities="ROLE_USER, ROLE_ADMIN" />
		</security:user-service>
	</security:authentication-provider>
	
	<bean id="configManager" class="org.springframework.flex.messaging.config.MessageBrokerBeanDefinitionParserTests$TestConfigurationManager"/>
	
	<bean id="processor1" class="org.springframework.flex.messaging.config.MessageBrokerBeanDefinitionParserTests$TestConfigProcessor"/>
	
	<bean id="processor2" class="org.springframework.flex.messaging.config.MessageBrokerBeanDefinitionParserTests$TestConfigProcessor"/>
	
</beans>